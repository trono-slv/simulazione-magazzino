<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestione Magazzino ‚Äî Sistema Professionale</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ===== HEADER ===== -->
    <header class="app-header">
        <div class="header-top">
            <div class="header-brand">
                <div class="brand-icon">üì¶</div>
                <div>
                    <h1>Gestione Magazzino</h1>
                    <p class="brand-sub">Sistema di Gestione Inventario Professionale</p>
                </div>
            </div>
            <div class="header-stats">
                <div class="stat-card">
                    <span class="stat-value" id="statArticoli">0</span>
                    <span class="stat-label">Articoli</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="statGiacenza">0</span>
                    <span class="stat-label">Giacenza Tot.</span>
                </div>
                <div class="stat-card stat-alert">
                    <span class="stat-value" id="statAllarmi">0</span>
                    <span class="stat-label">Allarmi Scorta</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="statValore">‚Ç¨ 0</span>
                    <span class="stat-label">Valore Magazzino</span>
                </div>
            </div>
        </div>
        <nav class="header-nav">
            <button class="nav-tab active" data-tab="inventario" onclick="switchTab('inventario')">üìã Inventario</button>
            <button class="nav-tab" data-tab="carico" onclick="switchTab('carico')">üì• Carico</button>
            <button class="nav-tab" data-tab="scarico" onclick="switchTab('scarico')">üì§ Scarico</button>
            <button class="nav-tab" data-tab="nuovo" onclick="switchTab('nuovo')">‚ûï Nuovo Articolo</button>
            <button class="nav-tab" data-tab="ddt" onclick="switchTab('ddt')">üöö DDT</button>
            <button class="nav-tab" data-tab="ordini" onclick="switchTab('ordini')">üìë Ordini</button>
        </nav>
    </header>

    <!-- ===== MAIN ===== -->
    <main class="app-main">

        <!-- ==================== SEZIONE INVENTARIO ==================== -->
        <section id="sec-inventario" class="section active">
            <div class="section-header">
                <div>
                    <h2>üìã Inventario Articoli</h2>
                    <p>Visualizza e gestisci tutti gli articoli presenti in magazzino</p>
                </div>
            </div>
            <div id="alertInventario"></div>
            <div class="toolbar">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInventario" placeholder="Cerca per codice, descrizione, posizione..." oninput="filtraInventario()">
                </div>
                <select id="filterCategoria" class="form-control" onchange="filtraInventario()" style="width:200px;">
                    <option value="">Tutte le categorie</option>
                    <option value="Elettronica">Elettronica</option>
                    <option value="Ferramenta">Ferramenta</option>
                    <option value="Abbigliamento">Abbigliamento</option>
                    <option value="Alimentari">Alimentari</option>
                    <option value="Cancelleria">Cancelleria</option>
                    <option value="Altro">Altro</option>
                </select>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Codice</th>
                            <th>Descrizione</th>
                            <th>Categoria</th>
                            <th class="text-center">U.M.</th>
                            <th class="text-right">Giacenza</th>
                            <th class="text-center">Stato</th>
                            <th class="text-right">Prezzo</th>
                            <th>Posizione</th>
                            <th class="text-center">Azioni</th>
                        </tr>
                    </thead>
                    <tbody id="inventarioBody"></tbody>
                </table>
            </div>
        </section>

        <!-- ==================== SEZIONE CARICO ==================== -->
        <section id="sec-carico" class="section">
            <div class="section-header">
                <div>
                    <h2>üì• Carico Merce</h2>
                    <p>Registra l'ingresso di nuova merce in magazzino</p>
                </div>
            </div>
            <div id="alertCarico"></div>
            <div class="card">
                <div class="card-header"><h3>Registra Carico</h3></div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Articolo *</label>
                            <select id="caricoArticolo" class="form-control">
                                <option value="">-- Seleziona articolo --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quantit√† *</label>
                            <input type="number" id="caricoQta" class="form-control" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label>Data *</label>
                            <input type="date" id="caricoData" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Fornitore</label>
                            <input type="text" id="caricoFornitore" class="form-control" placeholder="Nome fornitore">
                        </div>
                        <div class="form-group">
                            <label>N¬∞ Documento</label>
                            <input type="text" id="caricoDocumento" class="form-control" placeholder="DDT / Fattura">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-success" onclick="registraCarico()">üì• Registra Carico</button>
                    </div>
                </div>
            </div>
            <div class="card" style="margin-top:24px;">
                <div class="card-header"><h3>Storico Carichi</h3></div>
                <div class="card-body" style="padding:0;">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th><th>Ora</th><th>Codice</th><th>Descrizione</th>
                                    <th class="text-right">Qt√†</th><th>Fornitore</th><th>Documento</th>
                                </tr>
                            </thead>
                            <tbody id="caricoBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SEZIONE SCARICO ==================== -->
        <section id="sec-scarico" class="section">
            <div class="section-header">
                <div>
                    <h2>üì§ Scarico Merce</h2>
                    <p>Registra l'uscita di merce dal magazzino</p>
                </div>
            </div>
            <div id="alertScarico"></div>
            <div class="card">
                <div class="card-header"><h3>Registra Scarico</h3></div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Articolo *</label>
                            <select id="scaricoArticolo" class="form-control">
                                <option value="">-- Seleziona articolo --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quantit√† *</label>
                            <input type="number" id="scaricoQta" class="form-control" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <label>Data *</label>
                            <input type="date" id="scaricoData" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Causale</label>
                            <select id="scaricoCausale" class="form-control">
                                <option value="Vendita">Vendita</option>
                                <option value="Reso a fornitore">Reso a fornitore</option>
                                <option value="Uso interno">Uso interno</option>
                                <option value="Danneggiato">Danneggiato</option>
                                <option value="Altro">Altro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Destinatario / Cliente</label>
                            <input type="text" id="scaricoDestinatario" class="form-control" placeholder="Nome destinatario">
                        </div>
                        <div class="form-group">
                            <label>N¬∞ Documento</label>
                            <input type="text" id="scaricoDocumento" class="form-control" placeholder="DDT / Fattura">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-warning" onclick="registraScarico()">üì§ Registra Scarico</button>
                    </div>
                </div>
            </div>
            <div class="card" style="margin-top:24px;">
                <div class="card-header"><h3>Storico Scarichi</h3></div>
                <div class="card-body" style="padding:0;">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Data</th><th>Ora</th><th>Codice</th><th>Descrizione</th>
                                    <th class="text-right">Qt√†</th><th>Causale</th><th>Destinatario</th><th>Documento</th>
                                </tr>
                            </thead>
                            <tbody id="scaricoBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SEZIONE NUOVO ARTICOLO ==================== -->
        <section id="sec-nuovo" class="section">
            <div class="section-header">
                <div>
                    <h2>‚ûï Nuovo Articolo</h2>
                    <p>Aggiungi un nuovo articolo all'anagrafica di magazzino</p>
                </div>
            </div>
            <div id="alertNuovo"></div>
            <div class="card">
                <div class="card-header"><h3>Dati Articolo</h3></div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Codice Articolo</label>
                            <input type="text" id="nuovoCodice" class="form-control" readonly style="background:var(--gray-100);font-weight:700;">
                        </div>
                        <div class="form-group">
                            <label>Descrizione *</label>
                            <input type="text" id="nuovoDescrizione" class="form-control" placeholder="Nome dell'articolo">
                        </div>
                        <div class="form-group">
                            <label>Categoria *</label>
                            <select id="nuovoCategoria" class="form-control">
                                <option value="">-- Seleziona --</option>
                                <option value="Elettronica">Elettronica</option>
                                <option value="Ferramenta">Ferramenta</option>
                                <option value="Abbigliamento">Abbigliamento</option>
                                <option value="Alimentari">Alimentari</option>
                                <option value="Cancelleria">Cancelleria</option>
                                <option value="Altro">Altro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Unit√† di Misura *</label>
                            <select id="nuovoUM" class="form-control">
                                <option value="PZ">PZ - Pezzi</option>
                                <option value="KG">KG - Chilogrammi</option>
                                <option value="LT">LT - Litri</option>
                                <option value="MT">MT - Metri</option>
                                <option value="CF">CF - Confezione</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Giacenza Iniziale</label>
                            <input type="number" id="nuovoGiacenza" class="form-control" value="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>Scorta Minima</label>
                            <input type="number" id="nuovoScortaMin" class="form-control" value="5" min="0">
                        </div>
                        <div class="form-group">
                            <label>Prezzo Unitario (‚Ç¨)</label>
                            <input type="number" id="nuovoPrezzo" class="form-control" value="0" min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Posizione</label>
                            <input type="text" id="nuovoPosizione" class="form-control" placeholder="Es: Scaffale A-1">
                        </div>
                    </div>
                    <div class="form-group" style="margin-top:12px;">
                        <label>Note</label>
                        <textarea id="nuovoNote" class="form-control" rows="2" placeholder="Note aggiuntive..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-outline" onclick="resetFormNuovo()">üîÑ Reset</button>
                        <button class="btn btn-primary" onclick="creaNuovoArticolo()">‚ûï Crea Articolo</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SEZIONE DDT ==================== -->
        <section id="sec-ddt" class="section">
            <div class="section-header">
                <div>
                    <h2>üöö Documenti di Trasporto</h2>
                    <p>Emetti DDT e gestisci le spedizioni in uscita</p>
                </div>
            </div>
            <div id="alertDDT"></div>
            <div class="card">
                <div class="card-header"><h3>Nuovo DDT</h3></div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Numero DDT</label>
                            <input type="text" id="ddtNumero" class="form-control" readonly style="background:var(--gray-100);font-weight:700;">
                        </div>
                        <div class="form-group">
                            <label>Data *</label>
                            <input type="date" id="ddtData" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Destinatario *</label>
                            <input type="text" id="ddtDestinatario" class="form-control" placeholder="Ragione sociale">
                        </div>
                        <div class="form-group">
                            <label>Indirizzo</label>
                            <input type="text" id="ddtIndirizzo" class="form-control" placeholder="Indirizzo completo">
                        </div>
                        <div class="form-group">
                            <label>Causale Trasporto</label>
                            <select id="ddtCausale" class="form-control">
                                <option value="Vendita">Vendita</option>
                                <option value="Conto lavorazione">Conto lavorazione</option>
                                <option value="Conto visione">Conto visione</option>
                                <option value="Reso">Reso</option>
                                <option value="Omaggio">Omaggio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Trasporto a cura</label>
                            <select id="ddtTrasporto" class="form-control">
                                <option value="Mittente">Mittente</option>
                                <option value="Destinatario">Destinatario</option>
                                <option value="Vettore">Vettore</option>
                            </select>
                        </div>
                    </div>

                    <h4 style="margin:20px 0 12px;font-size:14px;color:var(--gray-700);">Aggiungi Articoli al DDT</h4>
                    <div class="form-grid" style="grid-template-columns:2fr 1fr auto;align-items:end;">
                        <div class="form-group">
                            <label>Articolo</label>
                            <select id="ddtArticoloSel" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Quantit√†</label>
                            <input type="number" id="ddtArticoloQta" class="form-control" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" onclick="aggiungiRigaDDT()">+ Aggiungi</button>
                        </div>
                    </div>
                    <div class="table-container" style="margin-top:12px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Codice</th><th>Descrizione</th><th class="text-center">U.M.</th>
                                    <th class="text-right">Qt√†</th><th class="text-center">Rimuovi</th>
                                </tr>
                            </thead>
                            <tbody id="ddtRigheBody"></tbody>
                        </table>
                    </div>
                    <div class="form-group" style="margin-top:12px;">
                        <label>Note DDT</label>
                        <textarea id="ddtNote" class="form-control" rows="2" placeholder="Note aggiuntive..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-outline" onclick="resetFormDDT()">üîÑ Reset</button>
                        <button class="btn btn-success" onclick="emettiDDT()">üöö Emetti DDT</button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top:24px;">
                <div class="card-header"><h3>DDT Emessi</h3></div>
                <div class="card-body" style="padding:0;">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Numero</th><th>Data</th><th>Destinatario</th><th>Causale</th>
                                    <th class="text-center">Articoli</th><th class="text-right">Valore</th>
                                    <th class="text-center">Azioni</th>
                                </tr>
                            </thead>
                            <tbody id="ddtListBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- ==================== SEZIONE ORDINI ==================== -->
        <section id="sec-ordini" class="section">
            <div class="section-header">
                <div>
                    <h2>üìë Gestione Ordini</h2>
                    <p>Crea e gestisci ordini di acquisto e vendita</p>
                </div>
            </div>
            <div id="alertOrdini"></div>
            <div class="card">
                <div class="card-header"><h3>Nuovo Ordine</h3></div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Numero Ordine</label>
                            <input type="text" id="ordineNumero" class="form-control" readonly style="background:var(--gray-100);font-weight:700;">
                        </div>
                        <div class="form-group">
                            <label>Data</label>
                            <input type="date" id="ordineData" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Fornitore / Cliente *</label>
                            <input type="text" id="ordineFornitore" class="form-control" placeholder="Ragione sociale">
                        </div>
                        <div class="form-group">
                            <label>Tipo Ordine</label>
                            <select id="ordineTipo" class="form-control">
                                <option value="Acquisto">Ordine di Acquisto</option>
                                <option value="Vendita">Ordine di Vendita</option>
                            </select>
                        </div>
                    </div>

                    <h4 style="margin:20px 0 12px;font-size:14px;color:var(--gray-700);">Aggiungi Articoli all'Ordine</h4>
                    <div class="form-grid" style="grid-template-columns:2fr 1fr auto;align-items:end;">
                        <div class="form-group">
                            <label>Articolo</label>
                            <select id="ordineArticoloSel" class="form-control"></select>
                        </div>
                        <div class="form-group">
                            <label>Quantit√†</label>
                            <input type="number" id="ordineArticoloQta" class="form-control" value="1" min="1">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" onclick="aggiungiRigaOrdine()">+ Aggiungi</button>
                        </div>
                    </div>
                    <div class="table-container" style="margin-top:12px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Codice</th><th>Descrizione</th><th>U.M.</th>
                                    <th class="text-right">Qt√†</th><th class="text-right">Subtotale</th><th class="text-center">Rimuovi</th>
                                </tr>
                            </thead>
                            <tbody id="ordineRigheBody"></tbody>
                        </table>
                    </div>
                    <div class="totale-box" id="ordineTotale"></div>
                    <div class="form-group" style="margin-top:12px;">
                        <label>Note Ordine</label>
                        <textarea id="ordineNote" class="form-control" rows="2" placeholder="Note aggiuntive..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-outline" onclick="resetFormOrdine()">üîÑ Reset</button>
                        <button class="btn btn-success" onclick="creaOrdine()">üìë Crea Ordine</button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top:24px;">
                <div class="card-header"><h3>Ordini Registrati</h3></div>
                <div class="card-body" style="padding:0;">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Numero</th><th>Data</th><th>Fornitore/Cliente</th><th>Tipo</th>
                                    <th class="text-center">Articoli</th><th class="text-right">Totale</th>
                                    <th class="text-center">Stato</th><th class="text-center">Aggiorna</th>
                                </tr>
                            </thead>
                            <tbody id="ordiniListBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- ===== MODALS ===== -->

    <!-- Modal Modifica Articolo -->
    <div class="modal-overlay" id="modalModifica">
        <div class="modal" style="max-width:640px;">
            <div class="modal-header">
                <h3>‚úèÔ∏è Modifica Articolo</h3>
                <button class="modal-close" onclick="chiudiModalModifica()">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="alertModifica"></div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Codice</label>
                        <input type="text" id="editCodice" class="form-control" readonly style="background:var(--gray-100);">
                    </div>
                    <div class="form-group">
                        <label>Descrizione *</label>
                        <input type="text" id="editDescrizione" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Categoria</label>
                        <select id="editCategoria" class="form-control">
                            <option value="Elettronica">Elettronica</option>
                            <option value="Ferramenta">Ferramenta</option>
                            <option value="Abbigliamento">Abbigliamento</option>
                            <option value="Alimentari">Alimentari</option>
                            <option value="Cancelleria">Cancelleria</option>
                            <option value="Altro">Altro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>U.M.</label>
                        <select id="editUM" class="form-control">
                            <option value="PZ">PZ</option>
                            <option value="KG">KG</option>
                            <option value="LT">LT</option>
                            <option value="MT">MT</option>
                            <option value="CF">CF</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Giacenza</label>
                        <input type="number" id="editGiacenza" class="form-control" min="0">
                    </div>
                    <div class="form-group">
                        <label>Scorta Minima</label>
                        <input type="number" id="editScortaMin" class="form-control" min="0">
                    </div>
                    <div class="form-group">
                        <label>Prezzo (‚Ç¨)</label>
                        <input type="number" id="editPrezzo" class="form-control" min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Posizione</label>
                        <input type="text" id="editPosizione" class="form-control">
                    </div>
                </div>
                <div class="form-group" style="margin-top:12px;">
                    <label>Note</label>
                    <textarea id="editNote" class="form-control" rows="2"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="chiudiModalModifica()">Annulla</button>
                <button class="btn btn-primary" onclick="salvaModifica()">üíæ Salva Modifiche</button>
            </div>
        </div>
    </div>

    <!-- Modal Elimina Articolo -->
    <div class="modal-overlay" id="modalElimina">
        <div class="modal" style="max-width:480px;">
            <div class="modal-header">
                <h3>üóëÔ∏è Conferma Eliminazione</h3>
                <button class="modal-close" onclick="chiudiModalElimina()">‚úï</button>
            </div>
            <div class="modal-body" style="text-align:center;">
                <div style="font-size:48px;margin-bottom:16px;">‚ö†Ô∏è</div>
                <p style="font-size:16px;margin-bottom:20px;">Sei sicuro di voler eliminare questo articolo?</p>
                <div style="background:var(--gray-50);padding:16px;border-radius:8px;border:1px solid var(--gray-200);text-align:left;">
                    <p><strong>Codice:</strong> <span id="eliminaCodice"></span></p>
                    <p><strong>Descrizione:</strong> <span id="eliminaDescrizione"></span></p>
                    <p><strong>Giacenza:</strong> <span id="eliminaGiacenza"></span></p>
                </div>
                <input type="hidden" id="eliminaCodiceHidden">
                <p style="font-size:12px;color:var(--danger);margin-top:12px;">Questa azione √® irreversibile!</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="chiudiModalElimina()">Annulla</button>
                <button class="btn btn-danger" onclick="confermaElimina()">üóëÔ∏è Elimina</button>
            </div>
        </div>
    </div>

    <!-- Modal Preview DDT -->
    <div class="modal-overlay" id="modalDDTPreview">
        <div class="modal" style="max-width:800px;">
            <div class="modal-header">
                <h3>üöö Anteprima DDT</h3>
                <button class="modal-close" onclick="chiudiModalDDT()">‚úï</button>
            </div>
            <div class="modal-body" id="ddtPreviewBody"></div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="chiudiModalDDT()">Chiudi</button>
                <button class="btn btn-primary" onclick="stampaDDT()">üñ®Ô∏è Stampa DDT</button>
            </div>
        </div>
    </div>

    <!-- ===== FOOTER ===== -->
    <footer style="text-align:center;padding:24px;color:var(--gray-500);font-size:12px;border-top:1px solid var(--gray-200);margin-top:40px;">
        <p>Gestione Magazzino ‚Äî Sistema Didattico Professionale | <button style="background:none;border:none;color:var(--danger);cursor:pointer;font-size:12px;text-decoration:underline;" onclick="resetTuttoDati()">üóëÔ∏è Reset Dati</button></p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
